<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="./favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" href="./assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" href="./assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" href="./assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" href="./assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" href="./apple-touch-icon.png" />
    <link rel="manifest" href="./manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        var scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          var element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          var hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          var newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((entries) => {
          setHeight();
        });
        resizeObserver.observe(obj.contentWindow.document.body);
      }
    </script>
    <marimo-filename hidden>notebook.py</marimo-filename>
    <marimo-mode data-mode='read' hidden></marimo-mode>
    <marimo-version data-version='0.13.7' hidden></marimo-version>
    <marimo-user-config data-config='{"completion": {"activate_on_typing": true, "copilot": false}, "display": {"default_width": "medium", "cell_output": "below", "default_table_page_size": 10, "dataframes": "rich", "theme": "light", "code_editor_font_size": 16}, "formatting": {"line_length": 79}, "keymap": {"preset": "default", "overrides": {}}, "runtime": {"auto_instantiate": true, "auto_reload": "off", "reactive_tests": true, "on_cell_change": "autorun", "watcher_on_save": "lazy", "output_max_bytes": 8000000, "std_stream_max_bytes": 1000000}, "save": {"autosave": "off", "autosave_delay": 1000, "format_on_save": false}, "package_management": {"manager": "pip"}, "server": {"browser": "default", "follow_symlink": false}, "language_servers": {"pylsp": {"enabled": true, "enable_mypy": true, "enable_ruff": true, "enable_flake8": false, "enable_pydocstyle": false, "enable_pylint": false, "enable_pyflakes": false}}, "snippets": {"custom_paths": [], "include_default_snippets": true}}' data-overrides='{}' hidden></marimo-user-config>
    <marimo-app-config data-config='{"width": "medium", "sql_output": "auto"}' hidden></marimo-app-config>
    <marimo-server-token data-token='123' hidden></marimo-server-token>
    <title>libanswers viz</title>
    <script type="module" crossorigin src="./assets/index-4h4O6nRv.js"></script>
    <link rel="stylesheet" crossorigin href="./assets/index-DredxwTT.css">
  <marimo-wasm hidden=""></marimo-wasm>
    <script>
        if (window.location.protocol === 'file:') {
            alert('Warning: This file must be served by an HTTP server to function correctly.');
        }
    </script>
    
    <style>
        #save-button {
            display: none !important;
        }
        #filename-input {
            display: none !important;
        }
    </style>
    <marimo-code hidden="" data-show-code="false">import%20marimo%0A%0A__generated_with%20%3D%20%220.13.7%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20return%20(mo%2C)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20io%0A%20%20%20%20import%20altair%20as%20alt%0A%20%20%20%20from%20datetime%20import%20datetime%0A%20%20%20%20return%20alt%2C%20datetime%2C%20io%2C%20pd%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20r%22%22%22%0A%20%20%20%20%23%20LibAnswers%20Analytics%20Visualizer%0A%0A%20%20%20%20This%20Marimo%20notebook%20run%20as%20a%20webapp%20automatically%20adjusts%20heatmaps%2C%20READ%20level%20comparison%20charts%2C%20and%20more%20based%20on%20an%20uploaded%20LibAnswers%20analytics%20CSV%20file.%20Filters%20in%20LibAnswers%20analytics%20are%20replicated%20here%2C%20with%20the%20additional%20funcationality%20of%20filtering%20by%20a%20range%20of%20READ%20levels.%20Additionally%2C%20the%20smallest%20unit%20of%20time%20is%20a%20week%2C%20not%20a%20month.%0A%20%20%20%20%22%22%22%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%23%20creating%20a%20UI%20element%20-%20file%20upload%0A%0A%20%20%20%20file_upload%20%3D%20mo.ui.file(%0A%20%20%20%20%20%20%20%20filetypes%3D%5B%22.csv%22%5D%2C%0A%20%20%20%20%20%20%20%20label%3D%22Upload%20a%20CSV%20file%22%2C%0A%20%20%20%20%20%20%20%20kind%3D%22button%22%2C%0A%20%20%20%20%20%20%20%20multiple%3DFalse%2C%0A%20%20%20%20)%0A%20%20%20%20return%20(file_upload%2C)%0A%0A%0A%40app.cell%0Adef%20_(file_upload)%3A%0A%20%20%20%20file_upload%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(file_upload%2C%20io%2C%20pd)%3A%0A%20%20%20%20def%20process_file()%3A%0A%20%20%20%20%20%20%20%20if%20file_upload.value%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Get%20the%20file%20upload%20results%0A%20%20%20%20%20%20%20%20%20%20%20%20file_obj%20%3D%20file_upload.value%5B0%5D%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Access%20the%20content%20directly%0A%20%20%20%20%20%20%20%20%20%20%20%20content%20%3D%20file_obj.contents%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20%23%20Convert%20to%20pandas%20DataFrame%0A%20%20%20%20%20%20%20%20%20%20%20%20df%20%3D%20pd.read_csv(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20io.BytesIO(content)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%20%20%23%20for%20Excel%20I'd%20use%20pd.read_excel(io.BytesIO(content))%20etc%20etc%0A%20%20%20%20%20%20%20%20%20%20%20%20df%20%3D%20df.drop(columns%3D%5B%22Ticket%20%23%22%2C%20%22Chat%20%23%22%5D).fillna(%22None%22)%0A%20%20%20%20%20%20%20%20%20%20%20%20df.insert(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20column%3D%22Date_time%22%2C%20loc%3D1%2C%20value%3D(df%5B%22Date%22%5D%20%2B%20%22%20%22%20%2B%20df%5B%22Time%22%5D)%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20df%5B%22Date_time%22%5D%20%3D%20pd.to_datetime(df%5B%22Date_time%22%5D)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20df%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20%22No%20file%20uploaded%20yet.%22%0A%20%20%20%20return%20(process_file%2C)%0A%0A%0A%40app.cell%0Adef%20_(process_file)%3A%0A%20%20%20%20df%20%3D%20process_file()%0A%20%20%20%20return%20(df%2C)%0A%0A%0A%40app.cell%0Adef%20_(df%2C%20mo)%3A%0A%20%20%20%20%23%20creating%20simpler%20UI%20elements%0A%0A%20%20%20%20date_range%20%3D%20mo.ui.date_range.from_series(df%5B%22Date_time%22%5D%2C%20label%3DNone)%0A%0A%20%20%20%20read_slider%20%3D%20mo.ui.range_slider(start%3D0%2C%20stop%3D6)%0A%0A%20%20%20%20read_break%20%3D%20mo.ui.number(start%3D0%2C%20stop%3D6%2C%20value%3D2)%0A%20%20%20%20return%20date_range%2C%20read_break%2C%20read_slider%0A%0A%0A%40app.cell%0Adef%20_(df%2C%20mo)%3A%0A%20%20%20%20%23%20creating%20metadata%20multiselect%20UI%20elements%0A%0A%20%20%20%20location_options%20%3D%20df%5B%22Location%22%5D.to_list()%0A%20%20%20%20entered_by_options%20%3D%20df%5B%22Entered%20By%22%5D.to_list()%0A%20%20%20%20patron_affiliation_options%20%3D%20df%5B%22Patron%20Affiliation%22%5D.to_list()%0A%20%20%20%20patron_status_options%20%3D%20df%5B%22Patron%20Status%22%5D.to_list()%0A%20%20%20%20communication_options%20%3D%20df%5B%22Communication%22%5D.to_list()%0A%20%20%20%20question_type_options%20%3D%20df%5B%22Question%20Type%22%5D.to_list()%0A%20%20%20%20duration_options%20%3D%20df%5B%22Duration%22%5D.to_list()%0A%0A%20%20%20%20%23%20I%20*can't*%20create%20these%20repetitive%20widgets%20with%20a%20fuction%2C%20as%20they%20need%20to%20be%20declared%20by%20name%20in%20the%20form%0A%0A%20%20%20%20location%20%3D%20mo.ui.multiselect.from_series(%0A%20%20%20%20%20%20%20%20df%5B%22Location%22%5D%2C%20value%3Dlocation_options%0A%20%20%20%20)%0A%20%20%20%20entered_by%20%3D%20mo.ui.multiselect.from_series(%0A%20%20%20%20%20%20%20%20df%5B%22Entered%20By%22%5D%2C%20value%3Dentered_by_options%0A%20%20%20%20)%0A%20%20%20%20patron_affiliation%20%3D%20mo.ui.multiselect.from_series(%0A%20%20%20%20%20%20%20%20df%5B%22Patron%20Affiliation%22%5D%2C%20value%3Dpatron_affiliation_options%0A%20%20%20%20)%0A%20%20%20%20patron_status%20%3D%20mo.ui.multiselect.from_series(%0A%20%20%20%20%20%20%20%20df%5B%22Patron%20Status%22%5D%2C%20value%3Dpatron_status_options%0A%20%20%20%20)%0A%20%20%20%20communication%20%3D%20mo.ui.multiselect.from_series(%0A%20%20%20%20%20%20%20%20df%5B%22Communication%22%5D%2C%20value%3Dcommunication_options%0A%20%20%20%20)%0A%20%20%20%20question_type%20%3D%20mo.ui.multiselect.from_series(%0A%20%20%20%20%20%20%20%20df%5B%22Question%20Type%22%5D%2C%20value%3Dquestion_type_options%0A%20%20%20%20)%0A%20%20%20%20duration%20%3D%20mo.ui.multiselect.from_series(%0A%20%20%20%20%20%20%20%20df%5B%22Duration%22%5D%2C%20value%3Dduration_options%0A%20%20%20%20)%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20communication%2C%0A%20%20%20%20%20%20%20%20duration%2C%0A%20%20%20%20%20%20%20%20entered_by%2C%0A%20%20%20%20%20%20%20%20location%2C%0A%20%20%20%20%20%20%20%20patron_affiliation%2C%0A%20%20%20%20%20%20%20%20patron_status%2C%0A%20%20%20%20%20%20%20%20question_type%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20communication%2C%0A%20%20%20%20date_range%2C%0A%20%20%20%20duration%2C%0A%20%20%20%20entered_by%2C%0A%20%20%20%20location%2C%0A%20%20%20%20mo%2C%0A%20%20%20%20patron_affiliation%2C%0A%20%20%20%20patron_status%2C%0A%20%20%20%20question_type%2C%0A%20%20%20%20read_break%2C%0A%20%20%20%20read_slider%2C%0A)%3A%0A%20%20%20%20%23%20form%20replaces%20vstacks%20for%20calling%20UI%20elements%20to%20solve%20an%20issue%20where%20changing%20values%20out-of-order%20would%20reset%20other%20UI%20selections%20-%20now%20all%20values%20are%20passed%20at%20once%0A%0A%20%20%20%20form%20%3D%20(%0A%20%20%20%20%20%20%20%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20The%20table%20and%20visualizations%20will%20update%20each%20time%20the%20%22Submit%22%20button%20is%20clicked.%0A%0A%20%20%20%20%20%20%20%20Choose%20a%20date%20range%20by%20selecting%20and%20typing%20over%20a%20component%2C%20or%20by%20using%20the%20calendar%20select.%3Cbr%3E%7Bdate_range%7D%20%3Cbr%3E%0A%20%20%20%20%20%20%20%20Drag%20the%20ends%20to%20select%20a%20READ%20scale%20range%20to%20include.%3Cbr%3E%7Bread_slider%7D%20%3Cbr%3E%0A%20%20%20%20%20%20%20%20Choose%20a%20number%20to%20split%20up%20high%20vs%20low%20READ%20levels.%3Cbr%3E%7Bread_break%7D%20%3Cbr%3E%0A%20%20%20%20%20%20%20%20%3Cbr%3E%0A%20%20%20%20%20%20%20%20%7Blocation%7D%20%3Cbr%3E%0A%20%20%20%20%20%20%20%20%7Bentered_by%7D%20%3Cbr%3E%0A%20%20%20%20%20%20%20%20%7Bpatron_affiliation%7D%20%3Cbr%3E%0A%20%20%20%20%20%20%20%20%7Bcommunication%7D%20%3Cbr%3E%0A%20%20%20%20%20%20%20%20%7Bquestion_type%7D%20%3Cbr%3E%0A%20%20%20%20%20%20%20%20%7Bduration%7D%0A%20%20%20%20%20%20%20%20%22%22%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.batch(%0A%20%20%20%20%20%20%20%20%20%20%20%20date_range%3Ddate_range%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20read_slider%3Dread_slider%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20read_break%3Dread_break%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20location%3Dlocation%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20entered_by%3Dentered_by%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20patron_affiliation%3Dpatron_affiliation%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20patron_status%3Dpatron_status%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20communication%3Dcommunication%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20question_type%3Dquestion_type%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20duration%3Dduration%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.form()%0A%20%20%20%20)%0A%20%20%20%20return%20(form%2C)%0A%0A%0A%40app.cell%0Adef%20_(form)%3A%0A%20%20%20%20form%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Date%2FTime%20stats%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(datetime%2C%20form)%3A%0A%20%20%20%20start_date%20%3D%20form.value%5B%22date_range%22%5D%5B0%5D%0A%20%20%20%20end_date%20%3D%20form.value%5B%22date_range%22%5D%5B1%5D%0A%0A%20%20%20%20start_datetime%20%3D%20datetime.combine(start_date%2C%20datetime.min.time())%0A%20%20%20%20end_datetime%20%3D%20datetime.combine(end_date%2C%20datetime.max.time())%0A%20%20%20%20date_string%20%3D%20(%0A%20%20%20%20%20%20%20%20f%22%7Bstart_date.strftime('%25d%20%25b%20%25Y')%7D%20to%20%7Bend_date.strftime('%25d%20%25b%20%25Y')%7D%22%0A%20%20%20%20)%0A%0A%20%20%20%20read_min%20%3D%20form.value%5B%22read_slider%22%5D%5B0%5D%0A%20%20%20%20read_max%20%3D%20form.value%5B%22read_slider%22%5D%5B1%5D%0A%0A%20%20%20%20read_break_level%20%3D%20form.value%5B%22read_break%22%5D%0A%20%20%20%20return%20(%0A%20%20%20%20%20%20%20%20date_string%2C%0A%20%20%20%20%20%20%20%20end_datetime%2C%0A%20%20%20%20%20%20%20%20read_break_level%2C%0A%20%20%20%20%20%20%20%20read_max%2C%0A%20%20%20%20%20%20%20%20read_min%2C%0A%20%20%20%20%20%20%20%20start_datetime%2C%0A%20%20%20%20)%0A%0A%0A%40app.cell%0Adef%20_(%0A%20%20%20%20df%2C%0A%20%20%20%20end_datetime%2C%0A%20%20%20%20form%2C%0A%20%20%20%20read_break_level%2C%0A%20%20%20%20read_max%2C%0A%20%20%20%20read_min%2C%0A%20%20%20%20start_datetime%2C%0A)%3A%0A%20%20%20%20%23%20main%20filtering%20logic%20responds%20to%20form%20entries%0A%0A%20%20%20%20filtered_df%20%3D%20df.copy()%0A%0A%20%20%20%20filtered_df%20%3D%20filtered_df%5B%0A%20%20%20%20%20%20%20%20(df%5B%22Date_time%22%5D%20%3E%3D%20start_datetime)%20%26%20(df%5B%22Date_time%22%5D%20%3C%3D%20end_datetime)%0A%20%20%20%20%5D%0A%0A%20%20%20%20filtered_df%20%3D%20filtered_df%5B(df%5B%22READ%22%5D%20%3E%3D%20read_min)%20%26%20(df%5B%22READ%22%5D%20%3C%3D%20read_max)%5D%0A%0A%20%20%20%20filtered_df%5B%22READ%20group%22%5D%20%3D%20filtered_df%5B%22READ%22%5D.apply(%0A%20%20%20%20%20%20%20%20lambda%20x%3A%20f%22Low%20(0-%7Bread_break_level%20-%201%7D)%22%0A%20%20%20%20%20%20%20%20if%20x%20%3C%20read_break_level%0A%20%20%20%20%20%20%20%20else%20f%22High%20(%7Bread_break_level%7D%20-6)%22%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20filtering%20from%20the%20multiselects%20could%20be%20a%20function%2C%20but%20it's%20easy%20to%20keep%20everything%20in%20this%20cell%0A%0A%20%20%20%20filtered_df%20%3D%20filtered_df%5Bfiltered_df%5B%22Location%22%5D.isin(form.value%5B%22location%22%5D)%5D%0A%20%20%20%20filtered_df%20%3D%20filtered_df%5B%0A%20%20%20%20%20%20%20%20filtered_df%5B%22Entered%20By%22%5D.isin(form.value%5B%22entered_by%22%5D)%0A%20%20%20%20%5D%0A%20%20%20%20filtered_df%20%3D%20filtered_df%5B%0A%20%20%20%20%20%20%20%20filtered_df%5B%22Patron%20Affiliation%22%5D.isin(form.value%5B%22patron_affiliation%22%5D)%0A%20%20%20%20%5D%0A%20%20%20%20filtered_df%20%3D%20filtered_df%5B%0A%20%20%20%20%20%20%20%20filtered_df%5B%22Patron%20Status%22%5D.isin(form.value%5B%22patron_status%22%5D)%0A%20%20%20%20%5D%0A%20%20%20%20filtered_df%20%3D%20filtered_df%5B%0A%20%20%20%20%20%20%20%20filtered_df%5B%22Communication%22%5D.isin(form.value%5B%22communication%22%5D)%0A%20%20%20%20%5D%0A%20%20%20%20filtered_df%20%3D%20filtered_df%5B%0A%20%20%20%20%20%20%20%20filtered_df%5B%22Question%20Type%22%5D.isin(form.value%5B%22question_type%22%5D)%0A%20%20%20%20%5D%0A%20%20%20%20filtered_df%20%3D%20filtered_df%5Bfiltered_df%5B%22Duration%22%5D.isin(form.value%5B%22duration%22%5D)%5D%0A%0A%20%20%20%20%23%20data%20transformations%20for%20plotting%20-%20not%20sure%20how%20many%20are%20still%20in%20use%3F%0A%0A%20%20%20%20date_time_pos%20%3D%20list(filtered_df.columns).index(%22Date_time%22)%0A%0A%20%20%20%20filtered_df.insert(%0A%20%20%20%20%20%20%20%20date_time_pos%20%2B%201%2C%20%22month%22%2C%20filtered_df%5B%22Date_time%22%5D.dt.month_name()%0A%20%20%20%20)%0A%20%20%20%20filtered_df.insert(date_time_pos%20%2B%202%2C%20%22day%22%2C%20filtered_df%5B%22Date_time%22%5D.dt.day)%0A%20%20%20%20filtered_df.insert(date_time_pos%20%2B%203%2C%20%22hour%22%2C%20filtered_df%5B%22Date_time%22%5D.dt.hour)%0A%20%20%20%20filtered_df.insert(%0A%20%20%20%20%20%20%20%20date_time_pos%20%2B%204%2C%20%22day_of_week%22%2C%20filtered_df%5B%22Date_time%22%5D.dt.day_name()%0A%20%20%20%20)%0A%20%20%20%20filtered_df.insert(%0A%20%20%20%20%20%20%20%20date_time_pos%20%2B%205%2C%0A%20%20%20%20%20%20%20%20%22yearweek%22%2C%0A%20%20%20%20%20%20%20%20filtered_df%5B%22Date_time%22%5D.dt.to_period(%22W%22).apply(lambda%20r%3A%20r.start_time)%2C%0A%20%20%20%20)%0A%20%20%20%20return%20(filtered_df%2C)%0A%0A%0A%40app.cell%0Adef%20_(filtered_df%2C%20mo)%3A%0A%20%20%20%20display_df%20%3D%20filtered_df.drop(%0A%20%20%20%20%20%20%20%20columns%3D%5B%22Date_time%22%2C%20%22Id%22%2C%20%22yearweek%22%2C%20%22hour%22%2C%20%22Date%22%5D%0A%20%20%20%20)%0A%0A%20%20%20%20mo.ui.table(display_df%2C%20page_size%3D15)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20%23%20creating%20a%20UI%20element%20-%20show%2Fhide%20LibAnswers%20plots%0A%0A%20%20%20%20switch%20%3D%20mo.ui.switch()%0A%20%20%20%20return%20(switch%2C)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20days_order%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%22Monday%22%2C%0A%20%20%20%20%20%20%20%20%22Tuesday%22%2C%0A%20%20%20%20%20%20%20%20%22Wednesday%22%2C%0A%20%20%20%20%20%20%20%20%22Thursday%22%2C%0A%20%20%20%20%20%20%20%20%22Friday%22%2C%0A%20%20%20%20%20%20%20%20%22Saturday%22%2C%0A%20%20%20%20%20%20%20%20%22Sunday%22%2C%0A%20%20%20%20%5D%0A%0A%20%20%20%20months_order%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%22January%22%2C%0A%20%20%20%20%20%20%20%20%22February%22%2C%0A%20%20%20%20%20%20%20%20%22March%22%2C%0A%20%20%20%20%20%20%20%20%22April%22%2C%0A%20%20%20%20%20%20%20%20%22May%22%2C%0A%20%20%20%20%20%20%20%20%22June%22%2C%0A%20%20%20%20%20%20%20%20%22July%22%2C%0A%20%20%20%20%20%20%20%20%22August%22%2C%0A%20%20%20%20%20%20%20%20%22September%22%2C%0A%20%20%20%20%20%20%20%20%22October%22%2C%0A%20%20%20%20%20%20%20%20%22November%22%2C%0A%20%20%20%20%20%20%20%20%22December%22%2C%0A%20%20%20%20%5D%0A%20%20%20%20return%20days_order%2C%20months_order%0A%0A%0A%40app.cell%0Adef%20_(filtered_df%2C%20months_order%2C%20pd)%3A%0A%20%20%20%20daily_counts%20%3D%20(%0A%20%20%20%20%20%20%20%20filtered_df.groupby(%22day_of_week%22).size().reset_index(name%3D%22count%22)%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20this%20transform%20is%20more%20complex%20because%20groupby(%22month%22)%20doesn't%20account%20for%20years%0A%20%20%20%20monthly_counts%20%3D%20(%0A%20%20%20%20%20%20%20%20filtered_df.set_index(%22Date_time%22)%0A%20%20%20%20%20%20%20%20.to_period(%22M%22)%0A%20%20%20%20%20%20%20%20.groupby(%22Date_time%22)%0A%20%20%20%20%20%20%20%20.size()%0A%20%20%20%20%20%20%20%20.reset_index(name%3D%22count%22)%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20the%20groupby%20makes%20it%20not%20a%20dt%20object%20and%20thus%20ruins%20the%20plot%20unless%20I%20re-dt%20it%0A%20%20%20%20monthly_counts%5B%22Date_time%22%5D%20%3D%20monthly_counts%5B%22Date_time%22%5D.dt.to_timestamp()%0A%0A%20%20%20%20calendar_data%20%3D%20(%0A%20%20%20%20%20%20%20%20filtered_df.groupby(%5B%22Date%22%2C%20%22month%22%2C%20%22day%22%2C%20%22day_of_week%22%5D)%0A%20%20%20%20%20%20%20%20.size()%0A%20%20%20%20%20%20%20%20.reset_index(name%3D%22count%22)%0A%20%20%20%20)%0A%0A%20%20%20%20calendar_data%5B%22Date%22%5D%20%3D%20pd.to_datetime(calendar_data%5B%22Date%22%5D)%0A%0A%20%20%20%20calendar_data%5B%22month%22%5D%20%3D%20pd.Categorical(%0A%20%20%20%20%20%20%20%20calendar_data%5B%22month%22%5D%2C%20categories%3Dmonths_order%2C%20ordered%3DTrue%0A%20%20%20%20)%0A%20%20%20%20return%20calendar_data%2C%20daily_counts%2C%20monthly_counts%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20daily_counts%2C%20date_string%2C%20days_order)%3A%0A%20%20%20%20day_bars%20%3D%20(%0A%20%20%20%20%20%20%20%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.Chart(daily_counts)%0A%20%20%20%20%20%20%20%20%20%20%20%20.mark_bar()%0A%20%20%20%20%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22day_of_week%3AO%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3DNone%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sort%3Ddays_order%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20axis%3Dalt.Axis(labelAngle%3D0)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%22count%22%2C%20title%3D%22Transactions%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.properties(%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3Dalt.Title(%22Daily%20sums%22%2C%20subtitle%3Ddate_string%2C%20anchor%3D%22start%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D700%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D300%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.configure_axis(labelFontSize%3D15%2C%20titleFontSize%3D18)%0A%20%20%20%20%20%20%20%20.configure_title(fontSize%3D25%2C%20subtitleFontSize%3D18)%0A%20%20%20%20)%0A%20%20%20%20return%20(day_bars%2C)%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20date_string%2C%20monthly_counts)%3A%0A%20%20%20%20month_bars%20%3D%20(%0A%20%20%20%20%20%20%20%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.Chart(monthly_counts)%0A%20%20%20%20%20%20%20%20%20%20%20%20.mark_bar()%0A%20%20%20%20%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22yearmonth(Date_time)%3AO%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3DNone%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20axis%3Dalt.Axis(labelAngle%3D0)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%22count%22%2C%20title%3D%22Transactions%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.properties(%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3Dalt.Title(%22Monthly%20sums%22%2C%20subtitle%3Ddate_string%2C%20anchor%3D%22start%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D700%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D300%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.configure_axis(labelFontSize%3D15%2C%20titleFontSize%3D18)%0A%20%20%20%20%20%20%20%20.configure_title(fontSize%3D25%2C%20subtitleFontSize%3D18)%0A%20%20%20%20)%0A%20%20%20%20return%20(month_bars%2C)%0A%0A%0A%40app.cell%0Adef%20_(day_bars%2C%20mo%2C%20month_bars%2C%20switch)%3A%0A%20%20%20%20mo.vstack(%0A%20%20%20%20%20%20%20%20%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20mo.md(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Toggle%20to%20add%20plots%20replicating%20the%20Monthly%20and%20Daily%20breakdowns%20in%20LibAnswers%20analytics.%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20switch%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20*(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5Bmo.ui.altair_chart(day_bars)%2C%20mo.ui.altair_chart(month_bars)%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20if%20switch.value%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20else%20%5B%22Not%20displaying%20LibAnswers-style%20charts.%22%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20calendar_data%2C%20date_string%2C%20mo)%3A%0A%20%20%20%20weekly_totals%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(calendar_data)%0A%20%20%20%20%20%20%20%20.mark_line()%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(%22yearweek(Date)%3AO%22%2C%20title%3DNone)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%22sum(count)%3AQ%22%2C%20title%3D%22Transactions%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%22yearweek(Date)%3AO%22%2C%20title%3D%22Week%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%22sum(count)%3AQ%22%2C%20title%3D%22Total%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.properties(%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3Dalt.Title(%22Weekly%20sums%22%2C%20subtitle%3Ddate_string%2C%20anchor%3D%22start%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D700%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D300%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.configure_axis(labelFontSize%3D15%2C%20titleFontSize%3D18)%0A%20%20%20%20%20%20%20%20.configure_title(fontSize%3D25%2C%20subtitleFontSize%3D18)%0A%20%20%20%20)%0A%0A%20%20%20%20mo.ui.altair_chart(weekly_totals)%0A%0A%20%20%20%20%23%20I'd%20love%20to%20do%20the%20interactive%20plot%20%2B%20table%20thing%20here%20but%20mo.vstack(%5Bchart%2C%20mo.ui.table(chart.value)%5D)%20doesn't%20work%20if%20I%20use%20Altair%20transforms%20in%20the%20plot%2C%20which%20I'm%20doing%20throughout%20this%20notebook%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Heatmaps%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(days_order%2C%20filtered_df%2C%20months_order%2C%20pd)%3A%0A%20%20%20%20%23%20filter%20for%20day-of-week%2Fhour%20heatmap%0A%20%20%20%20heatmap_days_data%20%3D%20(%0A%20%20%20%20%20%20%20%20filtered_df.groupby(%5B%22day_of_week%22%2C%20%22hour%22%5D)%0A%20%20%20%20%20%20%20%20.size()%0A%20%20%20%20%20%20%20%20.reset_index(name%3D%22count%22)%0A%20%20%20%20)%0A%0A%20%20%20%20heatmap_days_data%5B%22day_of_week%22%5D%20%3D%20pd.Categorical(%0A%20%20%20%20%20%20%20%20heatmap_days_data%5B%22day_of_week%22%5D%2C%20categories%3Ddays_order%2C%20ordered%3DTrue%0A%20%20%20%20)%0A%0A%20%20%20%20heatmap_days_data%20%3D%20heatmap_days_data.sort_values(%22day_of_week%22)%0A%0A%20%20%20%20%23%20filter%20for%20week%2Fday-of-week%20heatmap%0A%20%20%20%20heatmap_calendar_data%20%3D%20(%0A%20%20%20%20%20%20%20%20filtered_df.groupby(%5B%22month%22%2C%20%22day%22%5D).size().reset_index(name%3D%22count%22)%0A%20%20%20%20)%0A%0A%20%20%20%20heatmap_calendar_data%5B%22month%22%5D%20%3D%20pd.Categorical(%0A%20%20%20%20%20%20%20%20heatmap_calendar_data%5B%22month%22%5D%2C%20categories%3Dmonths_order%2C%20ordered%3DTrue%0A%20%20%20%20)%0A%20%20%20%20heatmap_calendar_data%20%3D%20heatmap_calendar_data.sort_values(%5B%22month%22%2C%20%22day%22%5D)%0A%20%20%20%20return%20(heatmap_days_data%2C)%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20date_string%2C%20days_order%2C%20heatmap_days_data%2C%20mo)%3A%0A%20%20%20%20heatmap_days%20%3D%20(%0A%20%20%20%20%20%20%20%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.Chart(heatmap_days_data)%0A%20%20%20%20%20%20%20%20%20%20%20%20.mark_rect()%0A%20%20%20%20%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22day_of_week%3AO%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3DNone%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sort%3Ddays_order%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20axis%3Dalt.Axis(labelAngle%3D0)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%20%20%23%20if%20I%20don't%20declare%20the%20sort%20it%20starts%20on%20Friday%3F%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%23%20the%20labelAngle%3D0%20keeps%20the%20labels%20horizontal%2C%20use%20-45%20for%20tilt%2C%20etc%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%22hour%3AO%22%2C%20title%3D%22Hour%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(%22count%3AQ%22%2C%20scale%3Dalt.Scale(scheme%3D%22viridis%22))%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%22day_of_week%22%2C%20%22hour%22%2C%20%22count%22%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20.properties(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3Dalt.Title(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Daily%2FHourly%20Distribution%20Heatmap%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20subtitle%3Ddate_string%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20anchor%3D%22start%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20width%3D700%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20height%3D400%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20spacing%3D5%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20.configure_scale(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bandPaddingInner%3D0.05%0A%20%20%20%20%20%20%20%20%20%20%20%20)%20%20%23%20whitespace%20between%20cells%20for%20readability%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.configure_axis(labelFontSize%3D15%2C%20titleFontSize%3D18)%0A%20%20%20%20%20%20%20%20.configure_title(fontSize%3D25%2C%20subtitleFontSize%3D18)%0A%20%20%20%20%20%20%20%20.configure_legend(titleFontSize%3D18%2C%20labelFontSize%3D15)%0A%20%20%20%20)%0A%0A%20%20%20%20mo.ui.altair_chart(heatmap_days)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20calendar_data%2C%20date_string%2C%20days_order%2C%20mo)%3A%0A%20%20%20%20heatmap_calendar%20%3D%20(%0A%20%20%20%20%20%20%20%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.Chart(calendar_data)%0A%20%20%20%20%20%20%20%20%20%20%20%20.mark_rect()%0A%20%20%20%20%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22day_of_week%3AO%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3DNone%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20sort%3Ddays_order%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20axis%3Dalt.Axis(labelAngle%3D0)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22yearweek(Date)%3AO%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3DNone%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22count%3AQ%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20scale%3Dalt.Scale(scheme%3D%22viridis%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20legend%3Dalt.Legend(title%3D%22Count%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%22Date%3AT%22%2C%20%22count%3AQ%22%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20.properties(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3Dalt.Title(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Weekly%2FDaily%20Distribution%20Heatmap%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20subtitle%3Ddate_string%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20anchor%3D%22start%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20width%3D700%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20height%3D400%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20spacing%3D5%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20.configure_scale(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20bandPaddingInner%3D0.05%0A%20%20%20%20%20%20%20%20%20%20%20%20)%20%20%23%20whitespace%20between%20cells%20for%20readability%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.configure_axis(labelFontSize%3D15%2C%20titleFontSize%3D18)%0A%20%20%20%20%20%20%20%20.configure_title(fontSize%3D25%2C%20subtitleFontSize%3D18)%0A%20%20%20%20%20%20%20%20.configure_legend(titleFontSize%3D18%2C%20labelFontSize%3D15)%0A%20%20%20%20)%0A%0A%20%20%20%20mo.ui.altair_chart(heatmap_calendar)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20READ%20level%20trends%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(filtered_df%2C%20pd)%3A%0A%20%20%20%20%23%20simple%20filter%20for%20READ-by-question%20bar%20plot%0A%20%20%20%20read_questions%20%3D%20(%0A%20%20%20%20%20%20%20%20filtered_df.groupby(%5B%22Question%20Type%22%2C%20%22READ%20group%22%5D)%0A%20%20%20%20%20%20%20%20.size()%0A%20%20%20%20%20%20%20%20.reset_index(name%3D%22count%22)%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20get%20unique%20weeks%20and%20READ_group%20combinations%0A%20%20%20%20all_weeks%20%3D%20filtered_df%5B%22yearweek%22%5D.drop_duplicates()%0A%20%20%20%20all_read_groups%20%3D%20filtered_df%5B%22READ%20group%22%5D.drop_duplicates()%0A%20%20%20%20full_index%20%3D%20pd.MultiIndex.from_product(%0A%20%20%20%20%20%20%20%20%5Ball_weeks%2C%20all_read_groups%5D%2C%20names%3D%5B%22yearweek%22%2C%20%22READ%20group%22%5D%0A%20%20%20%20)%0A%20%20%20%20full_df%20%3D%20pd.DataFrame(index%3Dfull_index).reset_index()%0A%0A%20%20%20%20%23%20get%20weekly%20counts%0A%20%20%20%20counts_df%20%3D%20(%0A%20%20%20%20%20%20%20%20filtered_df.groupby(%5B%22yearweek%22%2C%20%22READ%20group%22%5D)%0A%20%20%20%20%20%20%20%20.size()%0A%20%20%20%20%20%20%20%20.reset_index(name%3D%22count%22)%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20merge%20togther%20and%20fill%20missing%20values%20with%20zeroes%0A%20%20%20%20merged_df%20%3D%20pd.merge(%0A%20%20%20%20%20%20%20%20full_df%2C%20counts_df%2C%20on%3D%5B%22yearweek%22%2C%20%22READ%20group%22%5D%2C%20how%3D%22left%22%0A%20%20%20%20).fillna(0)%0A%20%20%20%20merged_df%5B%22count%22%5D%20%3D%20merged_df%5B%22count%22%5D.astype(int)%0A%20%20%20%20%23%20this%20df%20just%20holds%20weeks%20and%20their%20READ%20counts%20to%20do%20acurate%20line%20plots%20where%20zero%20counts%20aren't%20skipped%20by%20the%20line%0A%20%20%20%20return%20all_weeks%2C%20merged_df%2C%20read_questions%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20date_string%2C%20filtered_df%2C%20mo)%3A%0A%20%20%20%20read_compare_bar%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(filtered_df)%0A%20%20%20%20%20%20%20%20.mark_bar()%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(%22yearweek(Date_time)%3AT%22%2C%20title%3D%22Week%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%22count()%3AQ%22%2C%20title%3D%22Number%20of%20Transactions%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(%22READ%20group%3AN%22%2C%20title%3D%22READ%20Level%20Group%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%22yearweek(Date_time)%3AT%22%2C%20title%3D%22Week%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%22READ%20group%3AN%22%2C%20title%3D%22READ%20Group%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%22count()%3AQ%22%2C%20title%3D%22Count%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.properties(%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3Dalt.Title(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Weekly%20READ%20Level%20Trends%22%2C%20subtitle%3Ddate_string%2C%20anchor%3D%22start%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D700%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D400%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20spacing%3D5%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(%22yearweek(Date_time)%3AT%22%2C%20title%3D%22Week%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20xOffset%3D%22READ%20group%3AN%22%2C%20%20%23%20somehow%20this%20is%20what%20I%20need%20for%20side-by-side%20grouping%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.configure_axis(labelFontSize%3D15%2C%20titleFontSize%3D18)%0A%20%20%20%20%20%20%20%20.configure_title(fontSize%3D25%2C%20subtitleFontSize%3D18)%0A%20%20%20%20%20%20%20%20.configure_legend(%0A%20%20%20%20%20%20%20%20%20%20%20%20titleFontSize%3D18%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20labelFontSize%3D15%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20strokeColor%3D%22gray%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20fillColor%3D%22%23EEEEEE%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3D10%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20cornerRadius%3D10%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20add%20%2C%20orient%3D%22top-right%22%20to%20configure.legend%20to%20move%20it%20inside%20the%20plot%0A%0A%20%20%20%20mo.ui.altair_chart(read_compare_bar)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20date_string%2C%20merged_df%2C%20mo)%3A%0A%20%20%20%20read_compare_line%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(merged_df)%0A%20%20%20%20%20%20%20%20.mark_line(point%3DTrue)%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22yearweek(yearweek)%3AT%22%2C%20title%3D%22Week%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%20%20%23%20wrapping%20in%20Altair's%20yearweek%20for%20label%20consistency%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22count%3AQ%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3D%22Number%20of%20Transactions%22%2C%20%20%23%20%2C%20scale%3Dalt.Scale(domain%3D%5B0%2C%20140%5D)%20if%20topping%20out%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(%22READ%20group%3AN%22%2C%20title%3D%22READ%20Level%20Group%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%22yearweek%3AT%22%2C%20title%3D%22Week%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%22READ%20group%3AN%22%2C%20title%3D%22READ%20Group%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%22count%3AQ%22%2C%20title%3D%22Count%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.properties(%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3Dalt.Title(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Weekly%20READ%20Level%20Trends%22%2C%20subtitle%3Ddate_string%2C%20anchor%3D%22start%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D700%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D400%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20spacing%3D5%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.configure_axis(labelFontSize%3D15%2C%20titleFontSize%3D18)%0A%20%20%20%20%20%20%20%20.configure_title(fontSize%3D25%2C%20subtitleFontSize%3D18)%0A%20%20%20%20%20%20%20%20.configure_legend(%0A%20%20%20%20%20%20%20%20%20%20%20%20titleFontSize%3D18%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20labelFontSize%3D15%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20strokeColor%3D%22gray%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20fillColor%3D%22%23EEEEEE%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3D10%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20cornerRadius%3D10%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20add%20%2C%20orient%3D%22top-right%22%20to%20configure.legend%20to%20move%20it%20inside%20the%20plot%0A%0A%20%20%20%20mo.ui.altair_chart(read_compare_line)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20date_string%2C%20mo%2C%20read_questions)%3A%0A%20%20%20%20read_questiontype_bar%20%3D%20(%0A%20%20%20%20%20%20%20%20alt.Chart(read_questions)%0A%20%20%20%20%20%20%20%20.mark_bar()%0A%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%22Question%20Type%3AN%22%2C%20title%3DNone)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(%22count%3AQ%22%2C%20title%3D%22Number%20of%20Questions%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(%22READ%20group%3AN%22%2C%20title%3D%22READ%20Level%20Group%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20yOffset%3D%22READ%20group%3AN%22%2C%20%20%23%20this%20creates%20side-by-side%20bars%20like%20xOffset%20did%20for%20the%20Weekly%20READ%20level%20plot%0A%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%22Question%20Type%3AN%22%2C%20title%3D%22Question%20Type%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%22READ%20group%3AN%22%2C%20title%3D%22READ%20Level%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%22count%3AQ%22%2C%20title%3D%22Count%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.properties(%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3Dalt.Title(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22READ%20levels%20by%20question%20type%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20subtitle%3Ddate_string%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20anchor%3D%22start%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D700%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D400%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20spacing%3D5%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.configure_axis(labelFontSize%3D15%2C%20titleFontSize%3D18)%0A%20%20%20%20%20%20%20%20.configure_title(fontSize%3D25%2C%20subtitleFontSize%3D18)%0A%20%20%20%20%20%20%20%20.configure_legend(%0A%20%20%20%20%20%20%20%20%20%20%20%20titleFontSize%3D18%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20labelFontSize%3D15%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20strokeColor%3D%22gray%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20fillColor%3D%22%23EEEEEE%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3D10%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20cornerRadius%3D10%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20add%20%2C%20orient%3D%22top-right%22%20to%20configure.legend%20to%20move%20it%20inside%20the%20plot%0A%0A%20%20%20%20mo.ui.altair_chart(read_questiontype_bar)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%23%20Location%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(all_weeks%2C%20filtered_df%2C%20pd)%3A%0A%20%20%20%20%23%20simple%20filter%20for%20READ-by-location%20bar%20graph%0A%20%20%20%20location_read_data%20%3D%20(%0A%20%20%20%20%20%20%20%20filtered_df.groupby(%5B%22Location%22%2C%20%22READ%20group%22%5D)%0A%20%20%20%20%20%20%20%20.size()%0A%20%20%20%20%20%20%20%20.reset_index(name%3D%22count%22)%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20reusing%20how%20I%20did%20this%20for%20READ-by-week%0A%20%20%20%20%23%20get%20unique%20locations%20(reusing%20all_weeks%20from%20earlier)%0A%20%20%20%20all_locations%20%3D%20filtered_df%5B%22Location%22%5D.drop_duplicates()%0A%0A%20%20%20%20location_index%20%3D%20pd.MultiIndex.from_product(%0A%20%20%20%20%20%20%20%20%5Ball_weeks%2C%20all_locations%5D%2C%0A%20%20%20%20%20%20%20%20names%3D%5B%22yearweek%22%2C%20%22Location%22%5D%2C%0A%20%20%20%20)%0A%20%20%20%20location_full_df%20%3D%20pd.DataFrame(index%3Dlocation_index).reset_index()%0A%0A%20%20%20%20%23%20get%20weekly%20counts%20by%20location%0A%20%20%20%20location_week_data%20%3D%20(%0A%20%20%20%20%20%20%20%20filtered_df.groupby(%5B%22yearweek%22%2C%20%22Location%22%5D)%0A%20%20%20%20%20%20%20%20.size()%0A%20%20%20%20%20%20%20%20.reset_index(name%3D%22count%22)%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20merge%20together%20and%20fill%20missing%20values%20with%20zeroes%0A%20%20%20%20location_df%20%3D%20pd.merge(%0A%20%20%20%20%20%20%20%20location_full_df%2C%0A%20%20%20%20%20%20%20%20location_week_data%2C%0A%20%20%20%20%20%20%20%20on%3D%5B%22yearweek%22%2C%20%22Location%22%5D%2C%0A%20%20%20%20%20%20%20%20how%3D%22left%22%2C%0A%20%20%20%20).fillna(0)%0A%20%20%20%20location_df%5B%22count%22%5D%20%3D%20location_df%5B%22count%22%5D.astype(int)%0A%20%20%20%20return%20location_df%2C%20location_read_data%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20date_string%2C%20location_read_data%2C%20mo)%3A%0A%20%20%20%20location_read%20%3D%20(%0A%20%20%20%20%20%20%20%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.Chart(location_read_data)%0A%20%20%20%20%20%20%20%20%20%20%20%20.mark_bar()%0A%20%20%20%20%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%22Location%3AN%22%2C%20title%3DNone)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(%22count%3AQ%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(%22READ%20group%3AN%22%2C%20title%3D%22READ%20Level%20Group%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20yOffset%3D%22READ%20group%3AN%22%2C%20%20%23%20this%20creates%20side-by-side%20bars%20like%20xOffset%20did%20for%20the%20Weekly%20READ%20level%20plot%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20tooltip%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%22Location%3AN%22%2C%20title%3D%22Location%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%22READ%20group%3AN%22%2C%20title%3D%22READ%20Level%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20alt.Tooltip(%22count%3AQ%22%2C%20title%3D%22Count%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5D%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20.properties(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3Dalt.Title(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22READ%20levels%20by%20question%20location%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20subtitle%3Ddate_string%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20anchor%3D%22start%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20width%3D700%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20height%3D400%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20spacing%3D5%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20%20%20%20%20.configure_axis(labelFontSize%3D15%2C%20titleFontSize%3D18)%0A%20%20%20%20%20%20%20%20%20%20%20%20.configure_title(fontSize%3D25%2C%20subtitleFontSize%3D18)%0A%20%20%20%20%20%20%20%20%20%20%20%20.configure_legend(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20titleFontSize%3D18%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20labelFontSize%3D15%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20strokeColor%3D%22gray%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20fillColor%3D%22%23EEEEEE%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20padding%3D10%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20cornerRadius%3D10%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.properties(%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3Dalt.Title(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22READ%20Level%20counts%20by%20Location%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20subtitle%3Ddate_string%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20anchor%3D%22start%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D700%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D400%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20spacing%3D5%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.configure_axis(labelFontSize%3D15%2C%20titleFontSize%3D18)%0A%20%20%20%20%20%20%20%20.configure_title(fontSize%3D25%2C%20subtitleFontSize%3D18)%0A%20%20%20%20%20%20%20%20.configure_legend(%0A%20%20%20%20%20%20%20%20%20%20%20%20titleFontSize%3D18%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20labelFontSize%3D15%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20strokeColor%3D%22gray%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20fillColor%3D%22%23EEEEEE%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3D10%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20cornerRadius%3D10%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20add%20%2C%20orient%3D%22top-right%22%20to%20configure.legend%20to%20move%20it%20inside%20the%20plot%0A%0A%20%20%20%20mo.ui.altair_chart(location_read)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(alt%2C%20date_string%2C%20location_df%2C%20mo)%3A%0A%20%20%20%20location_compare_line%20%3D%20(%0A%20%20%20%20%20%20%20%20(%0A%20%20%20%20%20%20%20%20%20%20%20%20alt.Chart(location_df)%0A%20%20%20%20%20%20%20%20%20%20%20%20.mark_line(point%3DTrue)%0A%20%20%20%20%20%20%20%20%20%20%20%20.encode(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20x%3Dalt.X(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22yearweek(yearweek)%3AT%22%2C%20title%3D%22Week%22%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%20%20%23%20wrapping%20in%20Altair's%20yearweek%20for%20label%20consistency%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20y%3Dalt.Y(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22count%3AQ%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20title%3D%22Number%20of%20Transactions%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20color%3Dalt.Color(%22Location%3AN%22)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.properties(%0A%20%20%20%20%20%20%20%20%20%20%20%20title%3Dalt.Title(%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%22Weekly%20Location%20Trends%22%2C%20subtitle%3Ddate_string%2C%20anchor%3D%22start%22%0A%20%20%20%20%20%20%20%20%20%20%20%20)%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20width%3D700%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20height%3D400%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20spacing%3D5%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20%20%20%20%20.configure_axis(labelFontSize%3D15%2C%20titleFontSize%3D18)%0A%20%20%20%20%20%20%20%20.configure_title(fontSize%3D25%2C%20subtitleFontSize%3D18)%0A%20%20%20%20%20%20%20%20.configure_legend(%0A%20%20%20%20%20%20%20%20%20%20%20%20titleFontSize%3D18%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20labelFontSize%3D15%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20strokeColor%3D%22gray%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20fillColor%3D%22%23EEEEEE%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20padding%3D10%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20cornerRadius%3D10%2C%0A%20%20%20%20%20%20%20%20)%0A%20%20%20%20)%0A%0A%20%20%20%20mo.ui.altair_chart(location_compare_line)%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A</marimo-code></head>
  <body>
    <div id="root"></div>
  </body>
</html>
